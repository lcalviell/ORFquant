% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/orfquant.R
\name{detect_translated_orfs}
\alias{detect_translated_orfs}
\title{Detect actively translated ORFs}
\usage{
detect_translated_orfs(
  selected_txs,
  genome_sequence,
  annotation,
  P_sites,
  P_sites_uniq,
  P_sites_uniq_mm,
  genomic_region,
  genetic_code,
  all_starts = T,
  nostarts = F,
  start_sel_cutoff = NA,
  start_sel_cutoff_ave = 0.5,
  cutoff_fr_ave = 0.5,
  uniq_signal = F
)
}
\arguments{
\item{selected_txs}{set of selected transcripts, output from \code{select_txs}}

\item{genome_sequence}{BSgenome object}

\item{annotation}{Rannot object containing annotation of CDS and transcript structures (see \code{prepare_annotation_files})}

\item{P_sites}{GRanges object with P_sites positions}

\item{P_sites_uniq}{GRanges object with uniquely mapping P_sites positions}

\item{P_sites_uniq_mm}{GRanges object with uniquely mapping (with mismatches) P_sites positions}

\item{genomic_region}{GRanges object with genomic coordinates of the genomic region analyzed}

\item{genetic_code}{GENETIC_CODE table to use}

\item{all_starts}{\code{get_all_starts} parameter for the \code{get_orfs} function}

\item{nostarts}{\code{Stop_Stop} parameter for the \code{get_orfs} function}

\item{start_sel_cutoff}{\code{cutoff} parameter for the \code{select_start} function}

\item{start_sel_cutoff_ave}{\code{cutoff_ave} parameter for the \code{select_start} function}

\item{cutoff_fr_ave}{\code{cutoff} parameter for the  \code{calc_orf_pval} functions}

\item{uniq_signal}{Use only signal from uniquely mapping reads? Defaults to \code{FALSE}.}
}
\value{
A list with transcript coordinates, exonic coordinates and statistics for each ORF exonic bin and junction(from \code{select_txs}).\cr\cr
The value for each column is as follows:\cr\cr
\code{ave_pct_fr}: average percentage of in-frame reads for each codon in the ORF
\code{pct_fr}: percentage of in-frame reads in the ORF
\code{ave_pct_fr}: average percentage of in-frame reads for each codon in the ORF
\code{ave_pct_fr_st}: average percentage of in-frame reads per each codon between the selected start codon and the next candidate one
\code{pct_fr_st}: percentage of in-frame reads between the selected start codon and the next candidate one
\code{longest_ORF}: GRanges coordinates for the longest ORF with the same stop codon
\code{pval}: P-value for the multitaper F-test at 1/3 using the ORF P_sites profile
\code{pval_uniq}: P-value for the multitaper F-test at 1/3 using the ORF P_sites profile (only uniquely mapping reads)
\code{P_sites_raw}: Raw number of P_sites mapping to the ORF
\code{P_sites_raw_unique}: Uniquely mapping P_sites mapping to the ORF
\code{ORF_id_tr}: ORF id containing <tx_id>_<start>_<end>
\code{Protein}: AAString sequence of the translated protein
\code{region}: Genomic coordinates of the analyzed region
\code{gene_id}: gene_id for the corresponding analyzed transcript
\code{gene_biotype}: gene biotype for the corresponding analyzed transcript
\code{gene_name}: gene name for the corresponding analyzed transcript
\code{transcript_id}: transcript_id for the corresponding analyzed ORF
\code{transcript_biotype}: transcript biotype for the corresponding analyzed ORF
}
\description{
This function detects translated ORFs
}
\details{
A set of transcripts, together with genome sequence and Ribo-signal are analyzed to extract translated ORFs
}
\seealso{
\code{\link{select_txs}}, \code{\link{get_orfs}}, \code{\link{take_Fvals_spect}}, \code{\link{select_start}}, \code{\link{prepare_annotation_files}}
}
\author{
Lorenzo Calviello, \email{calviello.l.bio@gmail.com}
}
\keyword{ORFquant}
