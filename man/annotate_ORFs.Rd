% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/orfquant.R
\name{annotate_ORFs}
\alias{annotate_ORFs}
\title{Annotate detected ORFs in transcript and genome space}
\usage{
annotate_ORFs(results_ORFs, Annotation, genome_sequence, region,
  genetic_code)
}
\arguments{
\item{results_ORFs}{Full list of detected ORFs, from \code{select_quantify_ORFs}}

\item{Annotation}{Rannot object containing annotation of CDS and transcript structures (see \code{prepare_annotation_files}}

\item{genome_sequence}{BSgenome object}

\item{region}{genomic region being analyzed}

\item{genetic_code}{GENETIC_CODE table to use}
}
\value{
Exon structure of detected ORF including possible missing exons from reference, together with a \code{spl_type} column
including the annotation for each exon (e.g. alternative acceptors or donor).\cr\cr
Additional columns are added to the ORFs_tx object:\cr
\code{compatible_with}: Set of transcript ids possibly containing the entire ORF structure.\cr
\code{compatible_biotype}: Compatible transcript biotype; if a protein coding transcript can contain 
the ORF, this is set to protein_coding.\cr
\code{compatible_tx}: One selected compatible transcript (preference if protein_coding).\cr
\code{compatible_ORF_id_tr}: ORF_id_tr id if selecting the compatible transcript.\cr
\code{compatible_with_longest}: Same as \code{compatible_with} but using the most upstream start codon.\cr
\code{compatible_ORF_id_tr_longest}: Same as \code{compatible_ORF_id_tr} but using the most upstream start codon .\cr
\code{ref_id}: transcript_id of the transcript used to annotate splicing (longest) .\cr
\code{ref_id_maxORF}: ORF_id_tr of the ORF used to annotated splicing (most translated of the gene).\cr
\code{NC_protein_isoform}: Annotation of possible N or C termini variant (when transcript is protein_coding) .\cr
\code{ORF_category_Tx}: ORF annotation with respect to ORF position in the transcript .\cr
\code{ORF_category_Tx_compatible}: ORF annotation with respect to ORF position in the transcript, using the \code{compatible_ORF_id_tr} .\cr
\code{ORF_category_Gen}: ORF annotation with respect to its genomic position .\cr
\code{NMD_candidate}: TRUE or FALSE, depending on the presence of an additional exon-exon junction downstream the stop codon.\cr
\code{NMD_candidate_compatible_txs}: same as NMD_candidate, but for all transcripts compatible with the ORF structure.\cr
\code{Distance_to_lastExEx}: Distance (in nt) between the last exon-exon junction and the stop codon.\cr
\code{Distance_to_lastExEx_compatible_txs}: same as  Distance_to_lastExEx, but for all transcripts compatible with the ORF structure.
}
\description{
This function annotates quantified ORFs with respect to other detected ORFs and annotated ones, in both genome and transcript space.
}
\details{
As multiple transcripts can contain the same ORF,
all the transcript and transcript biotypes are indicated, with a preference for protein_coding transcripts in the "compatible" 
columns (to be conservative when assessing translation of non-protein coding transcripts). Such compatibility is also output considering the most upstream
start codon for that ORF. \cr
Splice features of each orf is annotated with respect to the longest coding transcripts and to the highest translated ORF in that gene.\cr
Variants in N or C terminus of the translated proteins are also indicated (Beta).\cr
ORF annotation with respect to the annotated transcript is also indicated, as follows:\cr\cr
\code{novel}: no ORF annotated in the transcript.\cr
\code{ORF_annotated}: same exact ORF as annotated.\cr
\code{N_extension}: N terminal extension.\cr
\code{N_truncation}: N terminal extension.\cr
\code{uORF}: upstream ORF.\cr
\code{overl_uORF}: upstream overlappin uORF.\cr
\code{NC_extension}: N and C termini extension.\cr
\code{dORF}: downstream ORF.\cr
\code{overl_dORF}: downstream overlapping ORF.\cr
\code{nested_ORF}: nested ORF.\cr
\code{C_truncation}: C terminal truncation.\cr
\code{C_extension}: C terminal extension.\cr\cr
As transcipt-specific annotation can be misleading due to a plethora of different transcripts, it is important to distinguish ORFs
also on the basis of their overlap with know CDS regions.
ORF annotation with respect to the entire set of CDS exon for the analyzed genomic regions is  indicated as follows:\cr\cr
\code{novel}: No CDS region is annotated in the entire region.\cr
\code{novel_Upstream}: ORF is upstream of annotated CDS regions (does not overlap).\cr
\code{novel_Downstream}: ORF is downstream of annotated CDS regions (does not overlap).\cr
\code{novel_Internal}: genomic location of the ORF is present between the start of the first,
 and the end of the last CDS region (does not overlap).\cr
\code{exact_start_stop}: Same start and end locations.\cr
\code{Alt5_start}: Different start region, upstream.\cr
\code{Alt3_start}: Different start region, downstream.\cr
\code{Alt5_stop}: Different end region, upstream.\cr
\code{Alt3_stop}: Different end region, downstream.\cr\cr
Another layer of annotation is performed by checking the position of the ORF stop codon 
with respect to the last exon-exon junction.
}
\seealso{
\code{\link{select_quantify_ORFs}}, \code{\link{annotate_splicing}}
}
\author{
Lorenzo Calviello, \email{calviello.l.bio@gmail.com}
}
\keyword{ORFquant}
